.. role:: raw-html-m2r(raw)
   :format: html

パイプライン
==============

NaxRiscvは複数のパイプラインで構成されている。

- **Fetch** : 特定のPCに生データを供給し、分岐予測の第一段階を提供し、PCのメモリ変換を行う
- **Frontend** : フェッチした生のデータを整列させ、デコードし、分岐予測の第2レベルを提供し、その後、命令に必要なリソースを割り当て、リネームする
- **実行ユニット** : 特定の命令に必要なリソースを取得し(RF、PCなど)、実行し、結果を書き戻し、完了を通知する。
- **LSU ロード** : データキャッシュを読み込み、メモリアドレスを変換し、古いストア依存関係をチェックし、最終的にストア値をバイパスする。
- **LSU ストア** : メモリアドレスを変換し、指定のストアに依存関係があり、完了通知を受け取った新しいロードをチェックする
- **LSU ライトバック** : コミットされたストアをデータキャッシュに書き込む

しかし、いくつかのステートマシンがあることも認識しておくべきである。

- **LSU Atomic** : コミットの順番が回ってきたSC/AMO操作を順次実行する。
- **MMU refill** : ページテーブルを巡回してTLBを再充填する
- **Privileged** : トラップおよび特権スイッチに必要なCSRをチェックし、更新する(mret、sret)

以下は一般的なアーキテクチャの図である:

.. image:: /asset/image/pipeline_simple.png
